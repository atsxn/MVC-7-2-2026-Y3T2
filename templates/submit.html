<!DOCTYPE html>
<html>
<head>
    <title>SUBMIT // CLAIM</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container" style="max-width: 600px; margin-top: 50px;">
        <div class="panel">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <h2>> INITIATE_CLAIM</h2>
                
                <div>
                    <a href="/" style="text-decoration:none; margin-right: 15px;">
                        <button type="button" style="width:auto; padding:5px 10px; font-size:0.8em; background:#ffff00; color:black;">
                            >: HOME
                        </button>
                    </a>
                    <a href="/logout" style="color:red; text-decoration:none; font-size:0.8em;">[ LOGOUT ]</a>
                </div>
            </div>

            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="alert-{{ category }}">
                            {{ message }}
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            <form action="/calculate" method="POST">
                <label>FIRST NAME</label>
                <input type="text" name="first_name" required>
                <br><br>
                <label>LAST NAME</label>
                <input type="text" name="last_name" required>
                <br><br>
                <label>MONTHLY INCOME (THB)</label>
                <input type="number" id="incomeInput" name="income" step="0.01" required placeholder="0.00">
                
                <div style="background:rgba(0,255,0,0.1); border:1px dashed #32ff7e; padding:15px; margin:20px 0; text-align:center;">
                    <span style="font-size:0.8em; color:#888;">// PREVIEW CALCULATION</span><br>
                    <span id="payoutDisplay" style="font-size:2em; font-weight:bold;">0.00</span> THB<br>
                    <span id="typeDisplay" style="color:#ffff00;">WAITING_INPUT</span>
                </div>

                <button type="submit">CONFIRM & SUBMIT</button>
            </form>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const incomeInput = document.getElementById('incomeInput');
            const payoutDisplay = document.getElementById('payoutDisplay');
            const typeDisplay = document.getElementById('typeDisplay');

            incomeInput.addEventListener('input', function(e) {
                let income = parseFloat(e.target.value) || 0;
                let payout = 0;
                let type = "WAITING";

                if (income < 6500) {
                    payout = 6500;
                    type = "TYPE: LOW INCOME";
                } else if (income >= 50000) {
                    payout = Math.min(income / 5, 20000);
                    type = "TYPE: HIGH INCOME";
                } else {
                    payout = Math.min(income, 20000);
                    type = "TYPE: GENERAL";
                }

                payoutDisplay.innerText = payout.toLocaleString(undefined, {minimumFractionDigits: 2});
                typeDisplay.innerText = type;
            });
        });
    </script>
</body>
</html>